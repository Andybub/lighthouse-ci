{%- assign dateNow = 'now' | date: '%c' -%}
{%- assign dateNow = dateNow | date: '%s' | times: 1 -%}
{%- assign minimumTime = 86400000 %}
<div class="container" id="Swiper-{{ section.id }}" data-section-id="{{ section.id }}">
  <div
    id="home-banner-swiper"
    class="swiper swiper-container"
    data-autoplay="{{ section.settings.slider_auto }}"
    data-loop="true"
    data-slides-per-view="1"
    data-space-between="0"
    data-delay="{{ section.settings.slider_rate }}"
    data-speed="800"
  >
    <ul class="swiper-wrapper">
      {%- for block in section.blocks %}
        {%- assign slideDeckStart = block.settings.start | date: '%s' | times: 1 %}
        {%- assign slideDeckEnd = block.settings.stop | date: '%s' | times: 1 %}
        {%- if dateNow > slideDeckStart and dateNow < slideDeckEnd %}
          <li class="swiper-slide">
            {%- if block.settings.countdown_enable %}
              {%- assign endTime = block.settings.stop | date: '%s' | times: 1 %}
              {%- assign salesText = 'Sale Ends In:' %}
              <div class="count-down-container position-absolute font-weight-bold text-nowrap" data-minimum-time="86400000" data-start-time="{{ slideDeckStart }}" data-end-time="{{ endTime }}" data-end-of-sales-text="The Sale Has Ended">
                <span class="sale-text">{{ salesText }}</span>
                <span class="countdown-clock"></span>
              </div>
            {%- endif %}
            <a href="{{ block.settings.link }}" class="gtm-banner">
              <picture>
                <source media="(max-width: 900px)" srcset="{{ block.settings.slide_mobile | img_url: '800x' | format: 'pjpg' }}" />
                <img src="{{ block.settings.slide | img_url: '2000x' | format: 'pjpg' }}" alt="{{ block.settings.image_alt_text }}" class="" width="1460" height="395" />
              </picture>
            </a>
          </li>
        {%- endif %}
      {%- endfor %}
    </ul>
    <div class="swiper-pagination swiper-pagination-white swiper-pagination-{{ section.id }} swiper-pagination-bullets">
      <span class="swiper-pagination-bullet swiper-pagination-bullet-active"></span>
      <span class="swiper-pagination-bullet"></span>
    </div>
    <div class="swiper-buttons position-absolute">
      <div class="content-buttons position-relative">
        <div class="swiper-button-prev sw-btn-prev-{{ section.id }} fkt-2x fkt-va"></div>
        <div class="swiper-button-next sw-btn-next-{{ section.id }} fkt-2x fkt-va"></div>
      </div>
    </div>
  </div>
</div>

{% schema %}
  {
    "name": "Index Slideshow",
    "class": "tw-slideshow-section",
    "presets": [
      {
        "name": "Slideshow",
        "category": "Image",
        "blocks":[
          {
          "type": "image",
          "type": "image",
          "type": "image"
         }
        ]
      }
    ],
    "settings": [
      {
        "type": "checkbox",
        "id": "slider_auto",
        "label": "Auto-rotate slides"
      },
      {
        "type": "select",
        "id": "slider_rate",
        "label": "Transition time",
        "options": [
          {
            "value": "5",
            "label": "5 seconds"
          },
          {
            "value": "7",
            "label": "7 seconds"
          },
          {
            "value": "10",
            "label": "10 seconds"
          },
          {
            "value": "15",
            "label": "15 seconds"
          }
        ]
      }
    ],
    "blocks" : [
      {
        "type": "image",
        "name": "Image",
        "settings": [
          {
            "type": "text",
            "id": "title",
            "label": "Block Title"
          },
          {
            "type": "image_picker",
            "id": "slide",
            "label": "Desktop Image"
          },
          {
            "type": "image_picker",
            "id": "slide_mobile",
            "label": "Mobile Image"
          },
          {
            "type": "url",
            "id": "link",
            "label": "Link URL"
          },
          {
            "type": "text",
            "id": "image_alt_text",
            "label": "Image Alt Text",
            "info": "for accessibility purposes: please enter description on what the image is all about. thanks"
          },
          {
            "type": "text",
            "id": "start",
            "label": "Start Time",
            "info": "ex: April 1 22 12:00:00 AM"
          },
          {
            "type": "text",
            "id": "stop",
            "label": "Stop Time",
            "info": "ex: April 2 2022 11:59:59 PM"
          },
          {
            "type": "checkbox",
            "id": "countdown_enable",
            "label": "Turn on countdown timer?",
            "default": true
          }
        ]
      }
    ]
  }
{% endschema %}
